<div id="cart-modal">
    <div>
        <div>
            <h1>CART (<span id="cart-count">{{ cart.total_items }}</span>)</h1>
            <button onclick="closeCart()">Ã—</button>
        </div>

        <div>
            <div id="cart-items">
                {% for item in cart_items %}
                    {% include 'cart/cart_item.html' %}
                {% empty %}
                    <div>
                        <p>Your cart is empty</p>
                        <button onclick="closeCart()">Continue shopping</button>
                    </div>
                {% endfor %}
            </div>
        </div>

        <div id="cart-summary">
            {% if cart_items %}
                {% include 'cart/cart_summary.html' %}
            {% else %}
                <div>
                    <p>Your cart is empty</p>
                </div>
            {% endif %}
        </div>
    </div>
</div>

<div id="cart-overlay"></div>

<script>
    function openCart() {
        const modal = document.getElementById('cart-modal');
        const overlay = document.getElementById('cart-overlay');
        if (modal && overlay) {
            modal.classList.remove('closed');
            modal.classList.add('open');
            overlay.classList.remove('closed');
            overlay.classList.add('open');
        }
    }

    function closeCart() {
        const modal = document.getElementById('cart-modal');
        const overlay = document.getElementById('cart-overlay');
        if (modal && overlay) {
            modal.classList.remove('open');
            modal.classList.add('closed');
            overlay.classList.remove('open');
            overlay.classList.add('closed');
            setTimeout(() => {
                const container = document.getElementById('cart-container');
                if (container) {
                    container.innerHTML = '';
                }
            }, 300);
        }
    }

    document.addEventListener('htmx:afterSwap', function(evt) {
        if (evt.detail.elt.id === 'cart-modal') {
            openCart();
        }
    });

    document.addEventListener('DOMContentLoaded', function() {
        const modal = document.getElementById('cart-modal');
        if (modal) {
            openCart();
        }
    });
</script>