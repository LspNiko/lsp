{% block content %}
<main>
	<!-- Breadcrumb and Filters -->
	<div>
		<h2>
			{% if current_category %} {{ current_category|upper }} > NEW ARRIVALS {%else %} ALL PRODUCTS {% endif %}
		</h2>
		<button
			hx-get="{% if current_category %}{% url 'main:catalog' current_category %}{% else %}{% url 'main:catalog_all' %}{% endif %}?show_filters=true&color={{ filter_params.color|urlencode }}&min_price={{ filter_params.min_price|urlencode }}&max_price={{ filter_params.max_price|urlencode }}&size={{ filter_params.size|urlencode }}"
			hx-target="#filter-modal-content"
			hx-swap="innerHTML"
			hx-on::after-request="document.getElementById('filter-modal').classList.remove('hidden')"
		>
			FILTERS
		</button>
	</div>

	<!-- Filter Modal Container -->
	<div id="filter-modal">
		<div id="filter-modal-content"></div>
	</div>

	<!-- Product Grid -->
	{% if products %}
	<div>
		{% for product in products %}
		<div
			class="product-card"
			hx-get="{% url 'main:product_detail' product.slug %}"
			hx-target="#main-content"
			hx-push-url="true"
		>
			<div>
				{% if product.main_image %}
				<img src="{{ product.main_image.url }}" alt="{{ product.name }}" />
				{% else %}
				<div>
					<span>No Image</span>
				</div>
				{% endif %}
			</div>
			<div>
				<h3>{{ product.name }}</h3>
				<p>{{ product.material }}</p>
				<p>${{ product.price }}</p>
			</div>
		</div>
		{% endfor %}
	</div>
	{% else %}
	<div>
		<h3>No products found</h3>
		<p>
			{% if current_category %} No products available in this category yet. {%
			else %} No products available at the moment. {% endif %}
		</p>
		<a
			href="{% url 'main:index' %}"
			hx-get="{% url 'main:index' %}"
			hx-target="#main-content"
			hx-push-url="true"
		>
			Back to Home
		</a>
	</div>
	{% endif %}
</main>

<script>
	// Product card hover and click functionality
	document.addEventListener('DOMContentLoaded', function () {
		const productCards = document.querySelectorAll('.product-card')
		productCards.forEach(card => {
			card.addEventListener('mouseenter', function () {
				this.style.transform = 'translateY(-2px)'
				this.style.transition = 'transform 0.3s ease'
			})

			card.addEventListener('mouseleave', function () {
				this.style.transform = 'translateY(0)'
			})
		})
	})
</script>
{% endblock %}
